import pyautogui
import time
import csv
import webbrowser  # ูุชุญ ุงูุฑุงุจุท ุจุงุณุชุฎุฏุงู ุงููุชุตูุญ ูุจุงุดุฑุฉ
import pyperclip  # ููุณุฎ ุงููุตูุต ุฅูู ุงูุญุงูุธุฉ

# ุงูุงูุชุธุงุฑ ููููุงู ุญุชู ุชุชููู ูู ูุชุญ ูุงุชุณุงุจ ูุณุทุญ ุงูููุชุจ
print("ุงูุชุธุฑ ููููุงูุ ุซู ุฑูุฒ ุนูู ูุงูุฐุฉ ูุงุชุณุงุจ...")
time.sleep(5)

# ุงูุฑุณุงูุฉ ุงูุชู ุชุฑูุฏ ุฅุฑุณุงููุง
message = """ูุฑุญุจุงู! ูุฐู ุฑุณุงูุฉ ุขููุฉ ูู ุงูุจูุช.

ููุงุ ูุนุงูู ุตูููุง ูู ูุชุฌุฑ 612! โจ

ุญุงุจูู ููุฏู ููู ุฒูุช ุจุฐูุฑ ุงูุตุจูุงุฑ ุงูุฃุตูู โ ุณุฑู ุงูุฌูุงู ุงูุทุจูุนู!

๐ฅ ุนุฑุถ ููุชุฑุฉ ูุญุฏูุฏุฉ: 3 ุฒุฌุงุฌุงุช (10 ูู) ุจุณ 30 ุฏููุงุฑ ูููุชู!

ูุชุฌุฑูุง ูู ุจุณ ุฒูุชุ ุนูุฏูุง ููููุงุช ุบุฐุงุฆูุฉ ูุฃูุถุง ุงุณุชุดุงุฑุงุช ุทุจูุฉ ูุฌุงููุฉ!
ุงููููุฉ ูุญุฏูุฏุฉ ูุงูุชูุตูู ุณุฑูุน ๐
ููุญุฌุฒ ูุงูุงุณุชูุณุงุฑุงุชุ ุชูุฏุฑูู ุชุฑูุญูู ุนูู https://www.herbalistclinic.com
"""

# ูุณุงุฑ ููู CSV ุงูุฐู ูุญุชูู ุนูู ุงูุฃุฑูุงู
csv_file_path = "C:\\Users\\emada\\OneDrive\\Desktop\\whatsappbot\\numbers.csv"

# ูุณุงุฑ ุงูุตูุฑุฉ ุงูุชู ุชุฑูุฏ ุฅุฑุณุงููุง
image_path = "C:\\Users\\emada\\OneDrive\\Desktop\\whatsappbot\\image.jpg"

# ุฏุงูุฉ ููุชุญ ุฌูุฉ ุงูุงุชุตุงู ุจูุงุกู ุนูู ุงูุฑูู
def open_contact_by_number(number):
    # ุงูุชุญ ูุงูุฐุฉ ุงูุฏุฑุฏุดุฉ ูุน ุงูุฑูู ุจุงุณุชุฎุฏุงู ุงูุฑุงุจุท ุงููุจุงุดุฑ ุนุจุฑ ุงููุชุตูุญ
    url = f'https://wa.me/{number}'
    webbrowser.open(url)  # ูุชุญ ุงูุฑุงุจุท ุจุงุณุชุฎุฏุงู ุงููุชุตูุญ
    time.sleep(5)  # ุงูุงูุชุธุงุฑ ููููุงู ุญุชู ูุชู ุชุญููู ุงููุญุงุฏุซุฉ

# ูุฑุงุกุฉ ุงูุฃุฑูุงู ูู ููู CSV
def read_numbers_from_csv(file_path):
    numbers = []
    with open(file_path, mode='r', encoding='utf-8') as file:
        csv_reader = csv.reader(file)
        next(csv_reader)  # ุชุฎุทู ุงูุนููุงู
        for row in csv_reader:
            numbers.append(row[0])  # ุฅุถุงูุฉ ุงูุฑูู ุฅูู ุงููุงุฆูุฉ
    return numbers

# ูุฑุงุกุฉ ุงูุฃุฑูุงู ูู ููู CSV
numbers = read_numbers_from_csv(csv_file_path)

# ุฅุฑุณุงู ุตูุฑุฉ ุซู ุฑุณุงูุฉ ููู ุฑูู
for number in numbers:
    print(f"ุฅุฑุณุงู ุตูุฑุฉ ุซู ุฑุณุงูุฉ ุฅูู: {number}")
    open_contact_by_number(number)  # ูุชุญ ุงูุฏุฑุฏุดุฉ ูุน ุงูุฑูู
    time.sleep(5)  # ุงูุงูุชุธุงุฑ ููููุงู ุญุชู ููุชุญ ุงูุฑุงุจุท ุจุดูู ุตุญูุญ

    # ุฅุฑุณุงู ุงูุตูุฑุฉ ุฃููุงู
    pyautogui.hotkey('ctrl', 'shift', 'a')  # ูุชุญ ูุงูุฐุฉ ุชุญููู ุงููููุงุช (ูู WhatsApp Web)
    time.sleep(2)  # ุงูุงูุชุธุงุฑ ููููุงู ุญุชู ูุชู ูุชุญ ูุงูุฐุฉ ุชุญููู ุงูุตูุฑุฉ
    pyautogui.write(image_path)  # ูุชุงุจุฉ ูุณุงุฑ ุงูุตูุฑุฉ
    pyautogui.press('enter')  # ุฅุฑุณุงู ุงูุตูุฑุฉ
    time.sleep(5)  # ุงูุงูุชุธุงุฑ ููููุงู ุจุนุฏ ุฅุฑุณุงู ุงูุตูุฑุฉ

    # ูุณุฎ ุงูุฑุณุงูุฉ ุฅูู ุงูุญุงูุธุฉ ุจุงุณุชุฎุฏุงู pyperclip
    pyperclip.copy(message)

    # ูุตู ุงูุฑุณุงูุฉ ูู ุงูุญุงูุธุฉ
    pyautogui.hotkey('ctrl', 'v')
    pyautogui.press('enter')  # ุฅุฑุณุงู ุงูุฑุณุงูุฉ
    time.sleep(2)  # ุงูุงูุชุธุงุฑ ุจุนุฏ ุฅุฑุณุงู ุงูุฑุณุงูุฉ

    print(f"ุชู ุฅุฑุณุงู ุงูุตูุฑุฉ ูุงูุฑุณุงูุฉ ุฅูู {number}")

print("ุชู ุฅุฑุณุงู ุงูุตูุฑ ูุงูุฑุณุงุฆู ูุฌููุน ุงูุฃุฑูุงู.")
